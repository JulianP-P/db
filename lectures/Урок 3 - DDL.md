Data Definition Language

## Основные объекты
### Кластер 
- База данных
- Табличное пространство
- Роль (пользователь)
### База данных
- Схема
  - Таблица
    - Индекс
  - Материализованное представление
  - Последовательность
  - Функция, процедура
  - Представление

Получение информации о бд (неважно, к какой бд подключились)
```sql
select * from pg_database
```
Подобная команда в psql
```
\l
\l+
```

Подключение к бд через psql
```sql
\c db_name
```

## Табличные пространства
Табличные пространства определяют физическое размещение данных в файловой системе
```
CREATE TABLESPACE табл_пространство
[ OWNER { новый_владелец | CURRENT_USER | SESSION_USER } ]
LOCATION 'каталог’
[ WITH ( параметр_табличного_пространства = значение [, ... ] ) ]
```
Имя табличного пространства (табл_пространство) не должно начинаться с pg_

Параметр табличного пространства – в настоящее время поддерживаются параметры, позволяющие переопределить оценки стоимости чтения данных в этом табличном пространстве:
- seq_page_cost,
- random_page_cost,
- effective_io_concurrency,
- maintenance_io_concurrency.

Каталог, который будет использован для этого табличного пространства. Этот каталог должен уже существовать - команда CREATE TABLESPACE не создает каталог.

Объекты одной базы данных могут быть размещены в нескольких табличных пространствах
В одном табличном пространстве могут быть размещены объекты нескольких баз данных

При установке кластера создаются два табличных пространства:
- pg_default – используется по умолчанию при создании объектов БД (если не было задано
другое ТС по умолчанию). Располагается в каталоге PGDATA/base, внутри этого каталога
объекты размещаются в подкаталогах баз данных
- pg_global – в этом ТС размещаются объекты, общие для всего кластера. Располагается в
каталоге PGDATA/global

Нельзя удалить табличное пространство до тех пор, пока в нем существует хотя бы один объект
(выражение CASCADE не определено для команды DROP TABLESPACE)

## CREATE
```sql
CREATE DATABASE имя
[ [ WITH ] [ OWNER [=] имя_пользователя ]     --Если не указано - пользователь, выполняющий команду
[ TEMPLATE [=] шаблон ]                       --По умолчанию - template1
[ ENCODING [=] кодировка ]                    --По умолчанию - кодировка шаблона
[ LOCALE [=] локаль ]                         --Краткий вариант определения значения для двух параметров LC_COLLATE и LC_CTYPE.
                                              --Исключает отдельное указание любого из этих параметров
[ LC_COLLATE [=] категория_сортировки ]       --Порядок сортировки. По умолчанию используется LC_COLLATE шаблона
[ LC_CTYPE [=] категория_типов_символов ]     --Классификация символов (принадлежность символов категориям, например: строчные, заглавные, цифры и т.п.).
                                              --По умолчанию используется классификация символов, установленная в шаблоне.
[ TABLESPACE [=] табл_пространство ]          --Tабличное пространство, которое будет использоваться по умолчанию для объектов, создаваемых в этой базе.
                                              --По умолчанию - табличное пространство шаблона.
[ ALLOW_CONNECTIONS [=] разр_подключения ]
[ CONNECTION LIMIT [=] предел_подключений ]
[ IS_TEMPLATE [=] это_шаблон ] ]
```
При установке кластера PostgreSQL создаются 3 базы данных:
- template0 - «Неизменный» шаблон. Его никогда нельзя менять (к нему даже подключиться нельзя)
- template1 - Шаблон по умолчанию. Но лучше его тоже не менять. Лучше создать свой шаблон и указывать его явно при создании бд.
- postgres - нужна для первого подключения к бд

## Изменение атрибутов базы данных (ALTER)
```sql
ALTER DATABASE имя RENAME TO новое_имя
ALTER DATABASE имя OWNER TO { новый_владелец | CURRENT_USER | SESSION_USER }
ALTER DATABASE имя SET TABLESPACE новое_табл_пространство
ALTER DATABASE имя SET параметр_конфигурации { TO | = } { значение | DEFAULT }
ALTER DATABASE имя SET параметр_конфигурации FROM CURRENT
ALTER DATABASE имя RESET параметр_конфигурации
ALTER DATABASE имя RESET ALL
```
Переименование бд
```sql
alter database old_name rename to new_name
```
